# 0021.tool_call_icon_rendering

## Background

AI tool calls currently appear as verbose blocks within the conversation, making it hard to scan the flow of messages. Representing tool calls as concise status icons will improve readability while still allowing access to detailed information on demand.

## User Story

> **As a** notebook user
> **I want** tool calls rendered as status icons with hover and click interactions
> **So that** I can quickly understand the outcome of AI function executions and inspect details only when needed

## Acceptance Criteria

1. Each tool call is rendered as a single icon representing its status:
   - Success → green circle with a white checkmark (e.g. `FaCheckCircle`)
   - Failure → red circle with a white cross (e.g. `FaTimesCircle`)
   - In-progress → blue circle with a spinner (e.g. `FaSpinner` w/ `animate-spin`)
   - Cancelled → orange circle with a line (e.g. `FaMinusCircle`)
2. Multiple tool calls contained in the same message appear inline, separated by 8 px–12 px of horizontal space.
3. Hovering an icon shows a tooltip that contains the tool name and status
4. Clicking an icon toggles a collapsible panel directly beneath the message that reveals the full JSON payload:
   - Request parameters
   - Full tool output / error object
5. Icons and panels are keyboard-accessible (TAB focus, Enter/Space to toggle) and meet WCAG 2.1 AA colour-contrast.
6. Unit tests verify icon rendering logic, tooltip content, click/keyboard toggling, and inline layout for multiple tool calls.
7. Existing integration tests for conversation rendering pass without modification.

## Technical Notes (optional)

- Extend `ToolCallDisplay` to a new `ToolCallIcon` component for the compact view.
- Use `react-icons/fa` for icons and Tailwind CSS utility classes for colours/spacing.
- Utilise `@headlessui/react` `Tooltip` or a custom Tailwind tooltip pattern.
- Collapsible panel can reuse existing markdown styling for JSON (`<pre><code>`).
- Ensure virtualised list scroll measurements include collapsed/expanded height changes.

## Out of Scope

- Custom SVG animations beyond the simple spinner.
- Persisting expanded/collapsed state across sessions.

## Potential Pitfalls (optional)

- Overlapping z-index causing tooltips to be hidden behind other elements.
- Large JSON payloads affecting performance—consider lazy-loading or code-block virtualization.

## Definition of Done

- All acceptance criteria are met.
- Unit / integration tests pass.
- Lint & type-check succeed.
- README updated under "Implemented user-stories" when feature is complete.
