# 0009.unified-chat-and-notebook

## Background

Current UI separates AI chat and notebook cells, causing context switches and fragmented workflow. Merging them into a single chronological conversation will improve readability, maintain context between chat guidance and code execution, and provide a seamless developer experience.

## User Story

> **As a** developer using the notebook
> **I want** AI chat messages and notebook cells to appear in one unified, scrollable conversation
> **So that** I can easily follow the discussion and code evolution without losing context.

## Acceptance Criteria

1. The conversation view renders chat messages and notebook cells as a single chronologically ordered list occupying the full viewport height.
2. Every chat message includes a unique `messageId` field.
3. Each notebook cell stores the `linkedMessageId` of the immediately preceding chat message (or `null` when the cell is the first item).
4. New notebook cells created by either the AI or the user are appended after the current last conversation item.
5. Notebook cells are rendered inside the conversation directly after the chat message (including all its parts) they are linked to.
6. The conversation list is vertically scrollable, while the message input panel remains fixed at the bottom of the screen.
7. Code is split into well-named React components, each placed in its own file under `src/components`.
8. Implementation passes all existing and new unit/integration tests and satisfies ESLint and TypeScript checks.

## Technical Notes (optional)

- Update cell and chat data models to include `messageId` and `linkedMessageId`.
- Use a virtualized list (e.g., `react-window`) if performance becomes an issue with many items.
- Maintain scroll position on new messages, ensuring the view stays pinned to the bottom when appropriate.

## Potential Pitfalls (optional)

- Ensuring stable keys when reordering or inserting elements to prevent React reconciliation issues.
- Synchronizing message and cell creation order in real-time collaborative scenarios.

## Definition of Done

- All acceptance criteria are met.
- Unit and integration tests cover linked IDs, rendering order, and scrolling behaviour.
- Linting and type-checking pass with no errors.
- README is updated to include the newly implemented story.
